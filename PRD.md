# PRD: Figma LLM 코드 생성 플러그인

## Problem Statement

Figma에서 완성된 UI를 코드로 옮기는 과정은 느리고 반복적이며 결과의 일관성이 낮다. 디자이너-엔지니어 핸드오프에서 레이아웃, 텍스트, 스타일, 변수/토큰의 해석 차이로 재작업이 빈번히 발생한다. 기존 Figma-to-code 도구는 규칙 기반 또는 고정 포맷에 묶여 있어 다양한 타겟 코드 포맷과 컴포넌트 구조를 유연하게 다루지 못한다. 사용자는 선택된 노드(또는 node id로 지정한 범위)를 기준으로, 신뢰 가능한 UI 코드를 빠르게 얻고 싶다.

## Target Users

- Figma로 UI를 설계하고 이를 코드로 옮겨야 하는 프론트엔드 엔지니어
- 디자인 시스템/컴포넌트 라이브러리를 유지하는 팀
- 프로덕트 디자이너/프로토타이핑 담당자(코드 기반 산출물 필요)

## Success Metrics

- 선택한 노드에서 코드 출력까지 평균 처리 시간 10초 이내
- 생성 코드의 컴파일/렌더링 성공률 80% 이상(추가 수정 없이)
- 디자인→코드 핸드오프 소요 시간 50% 이상 감소
- 복사된 코드의 재사용/채택률 60% 이상(팀/프로젝트 기준)

## 제품 정의

- Figma 플러그인에서 선택한 디자인(선택 노드 또는 node id)을 정규화된 IR로 변환한다.
- IR을 LangGraph 기반 LLM 에이전트에 전달해 다양한 코드 포맷의 UI 코드를 생성한다.
- 생성된 코드는 플러그인 UI에서 바로 확인하고 복사할 수 있다.

## 목표 (Goals)

- 선택한 디자인을 신뢰 가능한 UI 코드로 변환하는 end-to-end 파이프라인 제공
- 타겟 코드 포맷에 대한 확장성(LLM이 포맷 선택/생성)
- 디자이너-엔지니어 핸드오프 시간과 오류를 유의미하게 감소

## 비목표 (Non-Goals)

- 런타임 앱 빌더(즉시 실행되는 앱 생성) 제공
- 전체 제품 아키텍처 설계/백엔드 비즈니스 로직 생성
- 완전 자동 배포/PR 생성

## 사용자 흐름

1. 사용자가 Figma에서 노드 선택 또는 node id 입력
2. 플러그인이 선택 범위를 추출하고 IR로 정규화
3. 플러그인이 API로 LangGraph 에이전트를 호출
4. LLM이 타겟 코드 포맷을 결정하고 코드 생성
5. 플러그인 UI에서 코드 표시 및 복사

## 기능 요구사항 (Functional)

- Figma selection 및 node id 기반 추출 지원
- 레이아웃/텍스트/채움/스트로크/이펙트/변수 정보를 일관된 IR로 변환
- IR 스키마 검증 및 오류 메시지 제공
- API 호출을 통한 LLM 에이전트 실행
- 결과 코드 표시 및 복사 기능
- 실패/타임아웃 시 사용자 알림 및 재시도

## 시스템 구성 (Structural)

- Figma Main Thread: 노드 접근 및 데이터 추출
- IR Normalizer: 스타일/레이아웃/텍스트/변수 정규화
- API Client: 요청/응답 및 에러 처리
- LangGraph Agent Service: 프롬프트 구성, 모델 호출, 출력 포맷팅
- UI Thread(React): 코드 표시 및 복사 UX

## 의존성 (RPG)

- 노드 추출은 Figma selection/node id 입력에 의존
- IR 정규화는 추출 결과에 의존
- LLM 호출은 IR 검증 통과에 의존
- 코드 출력 UI는 LLM 응답에 의존

## 데이터/IR 원칙

- Figma Plugin API의 타입을 이해한 뒤 작업해야 함
- 타겟 포맷에 독립적인 구조 유지
- 레이아웃/스타일/텍스트/이펙트/변수 분리
- Figma 변수/토큰은 원본과 매핑 가능한 형태로 보존

## 리스크 및 완화

- LLM의 불안정한 출력 형식: 출력 스키마/포맷터로 안정화
- 복잡한 레이아웃 해석 오류: IR 정규화 규칙 강화
- 지연 시간 증가: 요청 데이터 최소화 및 캐싱 전략 검토

## MVP 전략

- 초기 MVP는 Figma - LLM 전달 및 Langchain, Langraph를 활용해서 응답을 생성하는 것
- Figma plugin의 UI 제작 및 서버 제작은 2차 MVP로 진행
- Figma 데이터를 LLM이 해석하기 용이하기 전달하는 것이 가장 중요하기 때문에, type-safe한 설계 및 유지보수 가능한 코드 구조가 중요
